<html>
<head>
    <script type="text/javascript"
            src="https://www.airconsole.com/api/airconsole-latest.js"></script>
    <script type="text/javascript" 
            src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript"
            src="airconsole-view-manager.js"></script>
    
	<link rel="stylesheet" type="text/css" href="controllerStyle.css">
</head>

<body onload="setup()">
	<!--START GAME SCREEN-->
    <div id="start" class="view">
        <div id="start_button" class="startbutton">
            Start game!
        </div>
    </div>

    <!--PLANNING SCREEN-->
    <div id="planning" class="view">
        <div class="button action_button map_button">
			MAP SWITCHBUTTON
		</div>
		<div id="planned_actions_area" class="planning_area" style="left: 20%">
			<div id="planned_action_1" class="button action_button" style="left: 13%">
				ACTION 1
			</div>
			<div id="planned_action_2" class="button action_button" style="left: 69%">
				ACTION 2
			</div>
        </div>
        <div id="action_button_area" class="planning_area" style="top: 31%">
          
            <div id="move_down_button" class="button action_button" style="left: 34%">
                DOWN
            </div>
            <div id="move_up_button" class="button action_button" style="left: 2%">
                UP
            </div>
            <div id="move_left_button" class="button action_button" style="left: 2%">
                LEFT
            </div>
            <div id="move_right_button" class="button action_button" style="left: 34%">
                RIGHT
            </div>
            
            <div id="dig_button" class="button action_button" style="left: 74%">
                DIG
            </div>
            <div id="interact_button" class="button action_button" style="left: 74%">
                INTERACT
            </div>
        </div>
        <div id="execute_turn_button_area" class="planning_area">
            <div id="execute_turn_button" class="button" style="left: 10%">
                TURN
            </div>
        </div>
        
    </div>
   
    <!--WAITING FOR TURN SCREEN-->
    <div id="waiting" class="view">
		<div class="button action_button map_button">
			MAP SWITCHBUTTON
		</div>
        <div class="planning_area" style="top: 4%">
			<div class="button action_button" style="left: 9%">
				ACTION 1
			</div>
			<div class="button action_button" style="left: 49%">
				ACTION 2
			</div>
        </div>
        <div class="planning_area" style="top: 31%">
          
            <div class="button action_button" style="left: 15%">
                DOWN
            </div>
            <div class="button action_button" style="left: 30%">
                UP
            </div>
            <div class="button action_button" style="left: 45%">
                LEFT
            </div>
            <div class="button action_button" style="left: 60%">
                RIGHT
            </div>

            <div class="button action_button" style="left: 75%">
                DIG
            </div>
            <div class="button action_button" style="left: 90%">
                INTERACT
            </div>
        </div>
        <div class="planning_area">
            <div class="button" style="left: 33%">
                TURN
            </div>
        </div>
	
    </div>
	
	<!-- MAP SCREEN -->
	<div id="map_screen" class="view default-view">
		<div class="button action_button map_button">
			MAP SWTICH BUTTON
		</div>
		<div class="map_area">
			<div id="map_1" class="map_piece">
				MAP PIECE TOP LEFT
			</div>
			<div id="map_2" class="map_piece">
				MAP PIECE TOP MIDDLE
			</div>
			<div id="map_3" class="map_piece">
				MAP PIECE TOP RIGHT
			</div>
			<div id="map_4" class="map_piece">
				MAP PIECE MIDDLE LEFT
			</div>
			<div id="map_5" class="map_piece">
				MAP PIECE MIDDLE
			</div>
			<div id="map_6" class="map_piece">
				MAP PIECE MIDDLE RIGHT
			</div>
			<div id="map_7" class="map_piece">
				MAP PIECE BOTTOM LEFT
			</div>
			<div id="map_8" class="map_piece">
				MAP PIECE BOTTOM MIDDLE
			</div>
			<div id="map_9" class="map_piece">
				MAP PIECE BOTTOM RIGHT
			</div>
		</div>
	</div>
    
    <script type="text/javascript">

        var airconsole;
        var vm;

        var possible_actions = ["move_left", "move_right", "move_up", "move_down", "interact", "attack", "dig"];
        var actions = [];
		var action_selector = 0;

        //Start menu buttons
        var start_button = document.getElementById("start_button");

        //Planning phase buttons
        var move_up_button = document.getElementById("move_up_button");
        var move_down_button = document.getElementById("move_down_button");
        var move_left_button = document.getElementById("move_left_button");
        var move_right_button = document.getElementById("move_right_button");
        /*var attack_button = document.getElementById("attack_button");*/
        var interact_button = document.getElementById("interact_button");
        var dig_button = document.getElementById("dig_button");
		
		var planned_action_buttons = [document.getElementById("planned_action_1"), document.getElementById("planned_action_2")];
		
        var execute_turn_button = document.getElementById("execute_turn_button");

		
		function setup() {
		
			airconsole = new AirConsole({"orientation": "landscape"});
		
			airconsole.onReady = function () {
				vm = new AirConsoleViewManager(airconsole);
			}

			airconsole.onMessage = function (device_id, data) {
			    console.log("Received message: " + data);
				if (device_id == AirConsole.SCREEN && data == 'turn') {
					vm.show('planning');
				};
			}
		};

        /*move_left_button.addEventListener('touchstart', function () { setAction(0, action_selector); });
        move_right_button.addEventListener('touchstart', function () { setAction(1, action_selector); }); 
		move_up_button.addEventListener('touchstart', function () { setAction(2, action_selector); });
        move_down_button.addEventListener('touchstart', function () { setAction(3, action_selector); });
        interact_button.addEventListener('touchstart', function () { setAction(4, action_selector); });
		attack_button.addEventListener('touchstart', function () { setAction(5, action_selector); });
		dig_button.addEventListener('touchstart', function () { setAction(6, action_selector); });
        
        planned_action_buttons[0].addEventListener('touchstart', function () {
			action_selector = 0;
		});
		planned_action_buttons[1].addEventListener('touchstart', function () { 
			action_selector = 1;
		});
        
        execute_turn_button.addEventListener('touchstart', function () {

		    console.log("Action 1: " + possible_actions[actions[0]] + ", index"  +  actions[0] + " Action 2: " + possible_actions[actions[1]] + " index " + actions[1]);
		    var message = { 
		        'action_1': actions[0], 
		        'action_2': actions[1]};

		    airconsole.message(AirConsole.SCREEN, message);



			vm.show('waiting');
		});*/
		
		move_left_button.addEventListener('click', function () { setAction(0, action_selector); });
		move_right_button.addEventListener('click', function () { setAction(1, action_selector); });
		move_up_button.addEventListener('click', function () { setAction(2, action_selector); });
		move_down_button.addEventListener('click', function () { setAction(3, action_selector); });
		interact_button.addEventListener('click', function () { setAction(4, action_selector); });
		/*attack_button.addEventListener('click', function () { setAction(5, action_selector); });*/
		dig_button.addEventListener('click', function () { setAction(5/*6*/, action_selector); });

		planned_action_buttons[0].addEventListener('click', function () {
			action_selector = 0;
		});
		planned_action_buttons[1].addEventListener('click', function () { 
			action_selector = 1;
		});
		
		execute_turn_button.addEventListener('click', function () {

		    console.log("Action 1: " + possible_actions[actions[0]] + ", index"  +  actions[0] + " Action 2: " + possible_actions[actions[1]] + " index " + actions[1]);
		    var message = { 
		        'action_1': actions[0], 
		        'action_2': actions[1]};

		    airconsole.message(AirConsole.SCREEN, message);



			vm.show('waiting');
		});
		
		function setAction(action, action_selector)
		{
		    console.log("Action: " + possible_actions[action] + " Set image to /img/" + possible_actions[action_selector] + ".png");
			actions[action_selector] = possible_actions[action];
			planned_action_buttons[action_selector].style.backgroundImage = "url('/img/" + possible_actions[action] + ".png')";
		};
    </script>

</body>

</html>